{"version":3,"sources":["webpack:///./src/views/SupervisionList.vue","webpack:///./src/components/webrtc/RemoteDes.vue","webpack:///src/components/webrtc/RemoteDes.vue","webpack:///./src/components/webrtc/RemoteDes.vue?1b75","webpack:///./src/components/webrtc/RemoteDes.vue?9e30","webpack:///src/views/SupervisionList.vue","webpack:///./src/views/SupervisionList.vue?f28b","webpack:///./src/views/SupervisionList.vue?1fad","webpack:///./src/components/webrtc/RemoteDes.vue?8d2e"],"names":["render","_vm","this","_c","_self","staticClass","_v","attrs","model","value","videoInputValue","callback","$$v","expression","_l","videoInputOptions","item","key","label","audioInputValue","audioInputOptions","audioOutputValue","audioOutputOptions","localMediaChecked","directives","name","rawName","moreDesCount","domProps","on","$event","target","composing","start","wsUrl","roomId","ref","moreDes","_s","refInFor","staticRenderFns","reportCount","currentReport","decoderImplementation","bytes","packets","packetsLost","frameWidth","frameHeight","framesPerSecond","audioOpen","localStream","props","data","pcConfig","socket","pc","srcSocketId","remoteStream","timeInterval","lastReport","methods","console","then","catch","sdpMLineIndex","candidate","startInterval","receiver","res","stop","createPeerConnection","type","id","getAnswer","handleAnswerError","sendMessage","component","components","RemoteDes","msg","mounted","video","audio","navigator","gotDevices","deviceInfos","vm","gotMediaStream","handleError"],"mappings":"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ACAlB,mBACAE,QACAC,UACAK,gBAIAW,SACA5B,SACA6B,uBACA,mBACA,qBACA,yBACA,+BACA,yBACA,kDAGAA,gCACA,oCACAA,yBACA,oCACAA,+CACA,8BAGA,6BAMA,GALAA,oCACA,gCACA,sBACAT,iBAEA,qBAIA,oBACA,2DACA,uBACAU,qBACAC,mCACA,yBACA,2BACAC,sBACAC,wBAEA,gCAGAJ,gDAhBAA,2CAoBA,yCACA,sBAEAK,gBAGA,mCACA,YAKA,IADA,WACA,wCAEA,8CACAC,4BACA,gDACA,+BAGA,GAGAA,sBACAC,cACA,2BAEA,GADAP,wBACA,WACA,OAEA,iCACA,8DACA,8GACA,qHAEA,qCAMA,MAEAQ,SAGAC,uBACAT,yCACA,6CACA,2BACA,YACA,8BACAU,iBACAtD,gCACAuD,sBACAP,kCAGAJ,0CAIA,oBACAA,8BACA,+BACA,oDAEA,mDACAA,mDAEA,yCAEA,wCAIAY,aAEAZ,4BACAA,oCACA,+BAGA,iCAEAa,qBACAb,6CAEAc,iBACA,gBAIA,6CACAd,kCACA,iCALAA,+CC3LkW,I,wBCQ9Ve,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,MAIa,EAAAA,E,oBCkCA,GACfC,YACAC,aAEAtD,uBACA2B,OACA4B,YAEA3B,OACA,OACAtC,qBACAK,qBACAE,sBACAZ,qBACAS,qBACAE,sBACA8B,iBACA5B,qBACAI,eACAO,6CACAC,oBAGAmB,UAAA,+JAGA2B,mBACA,mEAEA,CACA,OACAC,SACAC,UAEAC,uCACArB,0BACAA,sBACAC,6BATAF,mDAcAD,SACA5B,QACA,OACAC,iBACAC,mBACAmB,uBACAH,0DAGAW,wBACA,8BAEA,qCACA,wCAGAuB,cAEA,0BACA,0BACA,2BACA,WACAC,uBAEA,uBACAC,0BAAA,iCACA,0BACAA,+BAEA,wBACAA,2BAAA,iCACA,2BACAA,gCAEA,wBACAA,0BAAA,iCACA,0BACAA,mCAOAC,kBAGA,OAFA1B,gCACA,mBACA,2CAEA2B,eACA3B,8BCjJyV,ICOrV,EAAY,eACd,EACA9D,EACAwC,GACA,EACA,KACA,WACA,MAIa,e,2CClBf,W","file":"js/chunk-7cce3027.513b594a.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"supervisionList\"},[_c('div',[_c('label',[_vm._v(\"视频输入设备:\")]),_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.videoInputValue),callback:function ($$v) {_vm.videoInputValue=$$v},expression:\"videoInputValue\"}},_vm._l((_vm.videoInputOptions),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1),_c('label',[_vm._v(\"音频输入设备:\")]),_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.audioInputValue),callback:function ($$v) {_vm.audioInputValue=$$v},expression:\"audioInputValue\"}},_vm._l((_vm.audioInputOptions),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1),_c('label',[_vm._v(\"音频输出设备:\")]),_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.audioOutputValue),callback:function ($$v) {_vm.audioOutputValue=$$v},expression:\"audioOutputValue\"}},_vm._l((_vm.audioOutputOptions),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1),_c('div',[_c('el-checkbox',{model:{value:(_vm.localMediaChecked),callback:function ($$v) {_vm.localMediaChecked=$$v},expression:\"localMediaChecked\"}},[_vm._v(\"传输本地媒体\")]),_c('label',[_vm._v(\"额外终端连接:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.moreDesCount),expression:\"moreDesCount\"}],attrs:{\"placeholder\":\"额外终端连接\"},domProps:{\"value\":(_vm.moreDesCount)},on:{\"input\":function($event){if($event.target.composing)return;_vm.moreDesCount=$event.target.value}}}),_c('button',{attrs:{\"id\":\"connserver\"},on:{\"click\":_vm.start}},[_vm._v(\"启动\")]),_c('button',{attrs:{\"id\":\"leave\",\"disabled\":\"\"}},[_vm._v(\"关闭\")]),_vm._v(\" socket地址：\"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.wsUrl),expression:\"wsUrl\"}],attrs:{\"id\":\"socketHost\"},domProps:{\"value\":(_vm.wsUrl)},on:{\"input\":function($event){if($event.target.composing)return;_vm.wsUrl=$event.target.value}}}),_vm._v(\" socket房间：\"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.roomId),expression:\"roomId\"}],attrs:{\"id\":\"roomId\"},domProps:{\"value\":(_vm.roomId)},on:{\"input\":function($event){if($event.target.composing)return;_vm.roomId=$event.target.value}}}),_vm._v(\" 强制使用中继服务器:\"),_c('input',{attrs:{\"type\":\"checkbox\",\"id\":\"useRelay\"}}),_vm._v(\"chrome://webrtc-internals/ \")],1),_c('remote-des',{ref:\"RemoteDes\"}),_vm._l((9),function(moreDes){return _c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(moreDes<=_vm.moreDesCount),expression:\"moreDes<=moreDesCount\"}],key:moreDes},[_vm._v(\" RemoteDes\"+_vm._s(moreDes)+\" \"),_c('remote-des',{ref:'RemoteDes-'+moreDes,refInFor:true})],1)})],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"hello\"},[_c('div',{staticClass:\"videoDiv\"},[_c('div',{staticClass:\"videoNav\"},[_vm._v(\" decoderImp:\"+_vm._s(_vm.reportCount.currentReport!=null?_vm.reportCount.currentReport.decoderImplementation:\"\")),_c('br'),_vm._v(\" bytes:\"+_vm._s(_vm.reportCount.bytes)),_c('br'),_vm._v(\" packets:\"+_vm._s(_vm.reportCount.packets)),_c('br'),_vm._v(\" packetsLost:\"+_vm._s(_vm.reportCount.currentReport!=null?_vm.reportCount.currentReport.packetsLost:0)),_c('br'),_vm._v(\" frameSize:\"+_vm._s(_vm.reportCount.currentReport!=null?_vm.reportCount.currentReport.frameWidth:0)+\" \"+_vm._s(_vm.reportCount.currentReport!=null?_vm.reportCount.currentReport.frameHeight:0)),_c('br'),_vm._v(\" frames:\"+_vm._s(_vm.reportCount.currentReport!=null?_vm.reportCount.currentReport.framesPerSecond:0)),_c('br'),_vm._v(\" audioOpen:\"+_vm._s(_vm.reportCount.audioOpen)),_c('br')]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.localStream!=null),expression:\"localStream!=null\"}],staticClass:\"localVideoDiv\"},[_c('video',{ref:\"localVideo\",staticClass:\"localVideo\",attrs:{\"autoplay\":\"\",\"muted\":\"\",\"playsinline\":\"\"},domProps:{\"muted\":true}})]),_c('video',{ref:\"remoteVideo\",staticClass:\"remoteVideo\",attrs:{\"autoplay\":\"\",\"playsinline\":\"\"}})])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"hello\">\n    <div class=\"videoDiv\">\n        <div class=\"videoNav\">\n          decoderImp:{{reportCount.currentReport!=null?reportCount.currentReport.decoderImplementation:\"\"}}<br/>\n          bytes:{{reportCount.bytes}}<br/>\n          packets:{{reportCount.packets}}<br/>\n          packetsLost:{{reportCount.currentReport!=null?reportCount.currentReport.packetsLost:0}}<br/>\n          frameSize:{{reportCount.currentReport!=null?reportCount.currentReport.frameWidth:0}} {{reportCount.currentReport!=null?reportCount.currentReport.frameHeight:0}}<br/>\n          frames:{{reportCount.currentReport!=null?reportCount.currentReport.framesPerSecond:0}}<br/>\n          <!-- delay:{{reportCount.currentReport!=null?reportCount.currentReport.totalSquaredInterFrameDelay:0}}<br/> -->\n          audioOpen:{{reportCount.audioOpen}}<br/>\n        </div>\n        <div v-show=\"localStream!=null\" class=\"localVideoDiv\">\n          <video ref=\"localVideo\" class=\"localVideo\" autoplay muted playsinline></video>\n        </div>\n        <!-- <video id=\"remote-video\" style=\"max-height:400px;background-color:gainsboro;\"  autoplay></video> -->\n        <!-- <video id=\"remote-video\" style=\"height:840;width:1600;background-color:gainsboro;\"  autoplay></video> -->\n        <video ref=\"remoteVideo\" class=\"remoteVideo\" autoplay playsinline></video>\n    </div>\n  </div>\n</template>\n\n<script>\nimport io from 'socket.io-client';\n\nexport default {\n  props: {\n\n  },\n  data() {\n    return {\n      wsUrl: \"wss://localhost:8843\",\n      roomId: \"room-multi\",\n      pcConfig: {\"iceServers\":[{\"urls\":[\"stun:stun.l.google.com:19302\"]},{\"urls\":[\"turn:rtctest.zdomain.top:3478\"],\"username\":\"admin\",\"credential\":\"123456\"}],\"iceTransportPolicy\":\"all\"},\n      socket: null,\n      pc: null,\n      srcSocketId: null,\n      remoteStream: null,\n      localStream: null,\n      timeInterval: null,\n\n      reportCount:{\n        lastReport: null,\n        currentReport: null,\n        bytes: 0,\n        packets: 0,\n        audioOpen: false,\n      }\n    };\n  },\n  methods: {\n    start(config) {\n      console.log(\"start\",config);\n      this.wsUrl = config.wsUrl;\n      this.roomId = config.roomId;\n      this.pcConfig = config.pcConfig;\n      this.localStream = config.localStream;\n      if(this.localStream!=null){\n        this.$refs.localVideo.srcObject = this.localStream;\n      }\n\n      console.log(\"wss连接\"+this.wsUrl);\n      this.socket = io.connect(this.wsUrl);//this.wsUrl\n      console.log(this.socket);\n      this.socket.on('des-joined', (roomid, id) => {\n        console.log('receive des-joined message!', roomid, id);\n        this.createPeerConnection();\n      });\n      \n      this.socket.on('msg', (header,data) => {\n        console.log('receive message:', header, data);\n        this.srcSocketId = header.fromSocketId;\n        if(typeof data === 'string'){\n          data = JSON.parse(data);\n        }\n        if(data === null || data === undefined){\n          console.error('the message is invalid!');\n          return;\t\n        }\n        if(data.type === 'offer') {//data.hasOwnProperty('type') && \n          this.pc.setRemoteDescription(new RTCSessionDescription(data));\n          this.pc.createAnswer()\n            .then(this.getAnswer)\n            .catch(this.handleAnswerError);\n        }else if (data.type === 'candidate'){//data.hasOwnProperty('type') && \n          var candidate = new RTCIceCandidate({\n            sdpMLineIndex: data.label,\n            candidate: data.candidate\n          });\n          this.pc.addIceCandidate(candidate);\t\n        \n        }else{\n          console.log('the message is invalid!!!', data);\n        }\n      });\n\n      this.socket.emit('des-join', this.roomId);\n      this.startInterval();\n    },\n    startInterval(){\n      //clearInterval(this.timeInterval);\n      //this.timeInterval = null;\n      this.timeInterval = setInterval(()=>{\n        if (!this.pc) {\n          return;\n        }\n        //console.log(\"getReceivers\",this.pc.getReceivers(),this.pc.getReceivers().length);\n        var receiver = null;\n        for(var i=0;i<this.pc.getReceivers().length;i++){\n          //console.log(\"receiver\",this.pc.getReceivers()[i]);\n          if(this.pc.getReceivers()[i].track.kind==\"video\"){\n            receiver = this.pc.getReceivers()[i];\n          }else if(this.pc.getReceivers()[i].track.kind==\"audio\"){\n            this.reportCount.audioOpen = true;\n          }\n        }\n        if (!receiver) {\n          return;\n        }\n        receiver.getStats().then(res => {\n          res.forEach(report => {\n            if (report.type === 'inbound-rtp') {\n              console.log(\"report\",report);\n              if (report.isRemote) {\n                return;\n              }\n              this.reportCount.currentReport = report;\n              if(this.reportCount.lastReport && this.reportCount.currentReport){\n                this.reportCount.bytes = this.reportCount.currentReport.bytesReceived-this.reportCount.lastReport.bytesReceived;\n                this.reportCount.packets = this.reportCount.currentReport.packetsReceived-this.reportCount.lastReport.packetsReceived;\n              }\n              this.reportCount.lastReport = report;\n            }\n          });\n          //lastResult = res;\n        });\n\n      },1000);\n    },\n    stop() {\n\n    },\n    createPeerConnection() {\n      console.log('create RTCPeerConnection!');\n      this.pc = new RTCPeerConnection(this.pcConfig);\n      this.pc.onicecandidate = (e)=>{\n        if(e.candidate) {\n          this.sendMessage(this.roomId, {\n            type: 'candidate',\n            label:e.candidate.sdpMLineIndex, \n            id:e.candidate.sdpMid, \n            candidate: e.candidate.candidate\n          });\n        }else{\n          console.log('this is the end candidate');\n        }\n      }\n      //this.pc.ontrack = this.getRemoteStream;\n      this.pc.ontrack = (e)=>{\n        console.log(\"ontrack info\",e);\n        this.remoteStream = e.streams[0];\n        this.$refs.remoteVideo.srcObject = this.remoteStream;        \n      }\n      if(this.localStream === null || this.localStream === undefined) {\n        console.error('localstream is null or undefined!');\n      }else{\n        this.localStream.getTracks().forEach((track)=>{\n          //add all track into peer connection\n          this.pc.addTrack(track, this.localStream);\t\n        });\n      }\n    },\n    getAnswer(desc){\n      //desc.sdp = desc.sdp.replace(/VP/g,\"H26411111111\");\n      console.log(\"getAnswer:\",desc);\n      console.log(\"getAnswer sdp:\",desc.sdp);\n      this.pc.setLocalDescription(desc);\n      //answer.value = desc.sdp;\n      //send answer sdp\n      this.sendMessage(this.roomId,desc);\n    },\n    handleAnswerError(err){\n\t    console.error('Failed to create answer:', err);\n    },\n    sendMessage(roomid,data){\n      if(!this.socket){\n        console.error('sendMessage socket is null');\n        return;\n      }\n      var header = {\"roomId\":roomid,\"toSocketId\":this.srcSocketId};\n      console.log('send  message:', header, data);\n      this.socket.emit('msg', header, data);\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n.videoDiv{\n  width:640px;  \n  height:360px;\n  position: relative;\n}\n.videoNav{\n  text-align: left;\n  font-size: 12px;\n  background: rgba(0, 153, 145, 0.7);\n  position: absolute;\n  z-index: 1000;\n}\n.localVideoDiv{\n  background: rgba(111, 153, 145, 0.9);\n  position: absolute;\n  right: 0;\n  z-index: 1000; \n  width:128px;   \n  height:72px;\n}\n.remoteVideo{\n  width:640px;\n  height:360px;\n  background-color:gainsboro;\n  object-fit:fill;\n}\n.localVideo{\n  width:128px;   \n  height:72px;\n  background-color:gainsboro;\n  object-fit:fill;  \n}\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RemoteDes.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RemoteDes.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RemoteDes.vue?vue&type=template&id=90673a32&scoped=true&\"\nimport script from \"./RemoteDes.vue?vue&type=script&lang=js&\"\nexport * from \"./RemoteDes.vue?vue&type=script&lang=js&\"\nimport style0 from \"./RemoteDes.vue?vue&type=style&index=0&id=90673a32&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"90673a32\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"supervisionList\">\r\n    <div>\r\n      <label>视频输入设备:</label>\r\n      <el-select v-model=\"videoInputValue\" placeholder=\"请选择\">\r\n        <el-option\r\n          v-for=\"item in videoInputOptions\"\r\n          :key=\"item.value\"\r\n          :label=\"item.label\"\r\n          :value=\"item.value\">\r\n        </el-option>\r\n      </el-select>\r\n      <label>音频输入设备:</label>\r\n      <el-select v-model=\"audioInputValue\" placeholder=\"请选择\">\r\n        <el-option\r\n          v-for=\"item in audioInputOptions\"\r\n          :key=\"item.value\"\r\n          :label=\"item.label\"\r\n          :value=\"item.value\">\r\n        </el-option>\r\n      </el-select>\r\n      <label>音频输出设备:</label>\r\n      <el-select v-model=\"audioOutputValue\" placeholder=\"请选择\">\r\n        <el-option\r\n          v-for=\"item in audioOutputOptions\"\r\n          :key=\"item.value\"\r\n          :label=\"item.label\"\r\n          :value=\"item.value\">\r\n        </el-option>\r\n      </el-select>\r\n    </div>\r\n    <div>\r\n      <el-checkbox v-model=\"localMediaChecked\">传输本地媒体</el-checkbox>\r\n      <label>额外终端连接:</label>\r\n      <input v-model=\"moreDesCount\" placeholder=\"额外终端连接\"/>\r\n      <button id=\"connserver\" @click=\"start\">启动</button>\r\n      <button id=\"leave\" disabled>关闭</button>\t\t\t\t\r\n      socket地址：<input id=\"socketHost\" v-model=\"wsUrl\"/>\r\n      socket房间：<input id=\"roomId\" v-model=\"roomId\"/>\r\n      强制使用中继服务器:<input type=\"checkbox\" id=\"useRelay\" />chrome://webrtc-internals/\r\n    </div>\r\n    <remote-des ref=\"RemoteDes\"></remote-des>\r\n    <!-- <remote-des :wsUrl=\"wsUrl\" :roomId=\"roomId\" :ref=\"'RemoteDes2'\"></remote-des> -->\r\n    <div v-show=\"moreDes<=moreDesCount\" v-for=\"moreDes in 9\" :key=\"moreDes\">\r\n      RemoteDes{{moreDes}}\r\n      <remote-des :ref=\"'RemoteDes-'+moreDes\"></remote-des>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport RemoteDes from '@/components/webrtc/RemoteDes';\r\nimport urlUtil from '@/utils/urlUtil.js'\r\nexport default {\r\n  components: {\r\n    RemoteDes,\r\n  },\r\n  name: 'SupervisionList',\r\n  props: {\r\n    msg: String\r\n  },\r\n  data() {\r\n    return {\r\n      videoInputOptions: [],\r\n      audioInputOptions: [],\r\n      audioOutputOptions: [],\r\n      videoInputValue: null,\r\n      audioInputValue: null,\r\n      audioOutputValue: null,\r\n      localStream: null,\r\n      localMediaChecked: false,\r\n      moreDesCount: 0,\r\n      wsUrl: \"wss://\"+urlUtil.getUrlDomain()+\":8843\",\r\n      roomId: \"room-multi\",//test-multi room-multi\r\n      //wsUrl: \"wss://172.20.123.9:8843\",\r\n      //roomId: \"room1024-capture\",\r\n      pcConfig: {\"iceServers\":[{\"urls\":[\"stun:stun.l.google.com:19302\"]},{\"urls\":[\"turn:rtctest.zdomain.top:3478\"],\"username\":\"admin\",\"credential\":\"123456\"}],\"iceTransportPolicy\":\"all\"},\r\n    };\r\n  },\r\n  mounted:function(){\r\n    if(!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices){\r\n      console.log('enumerateDevices is not supported!');\r\n    }else{\r\n      var constraints = {\r\n        video : true, \r\n        audio : true \r\n      };\r\n      navigator.mediaDevices.getUserMedia(constraints)\r\n        .then(this.gotMediaStream)\r\n        .then(this.gotDevices)\r\n        .catch(this.handleError);\r\n    }\r\n\r\n    //console.log(\"urlUtil.getUrlDomain()\",urlUtil.getUrlDomain());\r\n  },\r\n  methods: {\r\n    start() {\r\n      var config = {\r\n        wsUrl:this.wsUrl,\r\n        roomId:this.roomId,\r\n        pcConfig:this.pcConfig,\r\n        localStream: this.localMediaChecked?this.localStream:null,\r\n        //localStream:null\r\n      };\r\n      console.log(\"start=\",config);\r\n      this.$refs.RemoteDes.start(config);\r\n\r\n      for (var i = 1; i <= this.moreDesCount; i++) {\r\n        this.$refs['RemoteDes-'+i][0].start(config);\r\n      }\r\n    },\r\n    gotDevices(deviceInfos){\r\n      //console.log(\"deviceInfos\",deviceInfos);\r\n      this.videoInputOptions = [];\r\n      this.audioInputOptions = [];\r\n      this.audioOutputOptions = [];\r\n      var vm = this;\r\n      deviceInfos.forEach(function(deviceInfo){\r\n        //console.log(deviceInfo.kind + \": label = \" + deviceInfo.label + \": id = \" + deviceInfo.deviceId + \": groupId = \" + deviceInfo.groupId);\t\r\n        if(deviceInfo.kind === 'audioinput'){\r\n          vm.audioInputOptions.push({\"value\":deviceInfo.deviceId,\"label\":deviceInfo.label});\r\n          if(vm.audioInputValue == null){\r\n            vm.audioInputValue = deviceInfo.deviceId;\r\n          }\r\n        }else if(deviceInfo.kind === 'audiooutput'){\r\n          vm.audioOutputOptions.push({\"value\":deviceInfo.deviceId,\"label\":deviceInfo.label});\r\n          if(vm.audioOutputValue == null){\r\n            vm.audioOutputValue = deviceInfo.deviceId;\r\n          }\r\n        }else if(deviceInfo.kind === 'videoinput'){\r\n          vm.videoInputOptions.push({\"value\":deviceInfo.deviceId,\"label\":deviceInfo.label});\r\n          if(vm.videoInputValue == null){\r\n            vm.videoInputValue = deviceInfo.deviceId;\r\n          }\r\n        }\r\n      });\r\n\r\n    },\r\n\r\n    gotMediaStream(stream){\r\n      console.log(\"gotMediaStream\",stream);\r\n      this.localStream = stream;\r\n      return navigator.mediaDevices.enumerateDevices();\r\n    },\r\n    handleError(err){\r\n\t    console.error('Failed:', err);\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n  ","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SupervisionList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SupervisionList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SupervisionList.vue?vue&type=template&id=e2f5ba4c&scoped=true&\"\nimport script from \"./SupervisionList.vue?vue&type=script&lang=js&\"\nexport * from \"./SupervisionList.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e2f5ba4c\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RemoteDes.vue?vue&type=style&index=0&id=90673a32&prod&scoped=true&lang=css&\""],"sourceRoot":""}